# АВС ИДЗ 4
Хан Виктория БПИ226 
Вариант 17

## Условие
Задача о капиталистической гостинице. В гостинице 10 номеров с ценой 2000 УЕ, 10 номеров с ценой 4000 УЕ и 5 номеров с ценой 6000 УЕ. Клиент, зашедший в гостиницу, обладает некоторой (случайной) суммой и получает номер по своим финансовым возможностям, если тот свободен. При наличии денег и разных по стоимости номеров он выбирает случайный номер. Если доступных по цене свободных номеров нет, клиент уходит искать ночлег в другое место. Клиенты порождаются динамически и уничтожаются при освобождении номера или уходе из гостиницы при невозможности оплаты. Создать многопоточное приложение, моделирующее работу гостиницы. Каждого клиента и гостиницу (точнее ее администратора) моделировать отдельным потоком.

Уточнения: Пользователь воодит количество секунд, которое отель будет работать. Также вводит количество секунд, за которое генерируется новый клиент. Если клиент бронирует комнату, он остается там на 20 секунд, а затем уходит (то есть допустим, что сутки это 20 секунд для менее времезатратного тестирования). 
Если у клиента достаточно денег на более чем один тип номеров, то он случайно выбирает из данных вариантов. Затем проверяем на наличие номера этого типа. Если есть свободные комнаты, посетитель может занять ее. В ином случае гость уходит из отеля. 
А еще у каждого клиента генерируется рандомная сумма денег от 1 до 10000. 

## Решение
Входные данные: время работы отеля в секундах, время генерации одного гостя
В самом начала инициализируются 25 mutex, которые олицетворяют комнаты в отеле (rooms). А также mutex, который связан с работой администрации (hotel_work). Запускается цикл, где сначала создается поток администрации (admin). Отель начинает работать, что отображается на состоянии переменной working, и блокируется mutex hotel work на количество секунд, введенное пользователем. В этом же цикле генерируются гости отеля каждые несколько секунд, пока working = true. Так как лишь первый инициированный администратор имеет доступ к hotel_work, который блокирует доступ к измнению переменной working, то другие инициализации администратора ждут, когда первый разблокирует mutex, то есть не влияют на работу программы.

Прописаны три типа комнат: за 2000 (1), за 4000 (2) и за 6000 (3). В массиве rooms, первые 10 комнат первого типа [0..9], вторые 10 - второго типа [10..19], последние 5 - третьего типа [20..24].   

При генерации клиента, инициируется отдельный поток. У гостя сначала рандомно генерируется количество денег (от 1 до 10000), затем roomType определяется по принципу: если у гостя >= 6000 денег, то он рандомно выбирает тип среди всех трех; если между 6000 и 4000, то рандомно выбирает тип между первым и вторым; если между 2000 и 4000, то может позволить себе только комнату первого типа; если меньше 2000 денег, то должен покинуть отель. 

После того, как roomType установлен, система проверяет наличие свободных комнат данного типа. Если есть свободные комнаты, то клиент его занимает. Если нет свободных комнат, клиент покидает отель. Каждый раз мы проходимся по определенному диапазону комнат в массиве rooms.
Когда администрация закрывает отель (working = false), новые гости не могут генерироваться, но уже заселившиеся гости могут покинуть свои номера после закрытия отеля. 

Модель: Управляющий и рабочие. Модель организации вычислений, при которой существует поток, координирующий работу всех остальных потоков. Как правило, управляющий поток распределяет данные, собирает и анализирует результаты.

## Вывод
* Когда гость не может позволить себе номер:
A guest with 692 comes in with 692 gold
Guest number 3 doesn't have enough money for a room
Guest number 3 leaves the hotel

* Когда гость может позволить себе только один тип номера:
A guest with 2021 comes in with 2021 gold
Guest number 12 wants a room of 2000 cost
Guest number 12 has taken room number 4

* Когда гость может позволить себе несколько вариантов типа номера:
A guest with 6347 comes in with 6347 gold
Guest number 1 wants a room of 6000 cost
Guest number 1 has taken room number 21
или
A guest with 6558 comes in with 6558 gold
Guest number 2 wants a room of 2000 cost
Guest number 2 has taken room number 1
или
A guest with 8039 comes in with 8039 gold
Guest number 6 wants a room of 4000 cost
Guest number 6 has taken room number 13

* Когда заканчиваются номера определенного типа:
A guest with 2908 comes in with 2908 gold
Guest number 13 wants a room of 2000 cost
There are no rooms of the right category
Guest number 13 leaves the hotel

## Выполнено на 6-7 баллов
* Соблюдены общие требования к отчету.
* В отчете должен быть приведен сценарий, описывающий одновременное поведение представленных в условии задания сущностей в терминах предметной области. То есть, описан сценарий, задающий ролевое поведение субъектов и объектов задачи (интерпретация условия с большей степенью детализации происходящего), а не то, как это будет реализовано в программе.
* Описана модель параллельных вычислений, используемая при разработке многопоточной программы.
* Описаны входные данные программы, включающие вариативные диапазоны, возможные при многократных запусках.
* Реализовано консольное приложение, решающее поставленную задачу с использованием одного варианта изученных синхропримитивов.
* Реализован ввод исходных данных из командной строки при запуске программы вместо ввода параметров с консоли во время выполнения программы.
* Для используемых генераторов случайных чисел описаны их диапазоны и то, как интерпретируются данные этих генераторов.
* Вывод программы должен быть информативным, отражая все ключевые протекающие в ней события в терминах предметной области. Наблюдатель на основе вывода программы должен понимать, что в ней происходит в каждый момент времени ее работы.
* В программе присутствуют комментарии, поясняющие выполняемые действия и описание используемых объектов и переменных.
* В отчете подробно описан обобщенный алгоритм, используемый при реализации программы исходного словесного сценария. В котором показано, как на программу отображается каждый из субъектов предметной области.
* В программу добавлена генерация случайных данных в допустимых диапазонах.
* Результаты работы программы представлены в отчете.

